format:
	@echo
	@for d in modules/* ; \
	 do \
			terraform fmt "$$d" ; \
			echo "Module $$d formatted... âœ…" ; \
	done
	@echo "\nAll modules formatted ðŸŽ‰"


generate-docs: 
	@echo
	@for d in modules/* ; \
	 do \
			terraform-docs md "$$d" >"$$d/README.md" ; \
			echo "Module $$d/README.md written... âœ…" ; \
	done
	@echo "\nAll modules README.md documentation up to date ðŸŽ‰"

scan:
	@echo
	@for d in modules/* ; \
	 do \
	 		echo "Scanning module $$d... " ; \
			tfsec --minimum-severity CRITICAL "$$d" || true ; \
	done
	@echo "\nAll modules scanned ðŸŽ‰\n"


all: format generate-docs scan

.PHONY: format generate-docs scan